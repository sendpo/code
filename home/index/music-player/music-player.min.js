window.addEventListener("load",function(){const e=document.getElementById("audio-player"),t=document.getElementById("player-container"),n="https://www.hhlqilongzhu.cn/api/wangyi_hot_review.php";let a=null,o=!1;async function i(){try{t.innerHTML='<div class="player-loading"><i class="fas fa-spinner fa-spin"></i> 正在切换歌曲...</div>';const i=await fetch(n),r=await i.json();if(200!==r.code||!r.url)throw new Error("歌曲数据异常");t.innerHTML=`<div class="player-content"><img src="${r.img}" alt="${r.song}" class="player-cover" id="current-cover"><div class="player-info"><div class="player-song">${r.song}</div><div class="player-singer">${r.singer}</div><div class="player-control-wrapper"><div class="player-controls"><button id="play-btn" class="player-btn"><i class="fas fa-play"></i></button><button id="pause-btn" class="player-btn" style="display:none;"><i class="fas fa-pause"></i></button><button id="next-btn" class="player-btn"><i class="fas fa-step-forward"></i></button></div></div><div class="progress-container"><div class="progress-played"></div><div class="progress-handle"></div></div><div class="progress-time"><span class="current-time-text">0:00</span><span class="total-time-text">0:00</span></div><a href="${r.link}" target="_blank" class="player-link"><i class="fab fa-napster"></i> 前往网易云音乐查看</a></div></div>`,a=document.getElementById("current-cover"),e.src=r.url,o&&e.play().catch(()=>{}),initProgressDrag(),document.getElementById("play-btn").onclick=()=>{o=!0,e.play(),document.getElementById("play-btn").style.display="none",document.getElementById("pause-btn").style.display="flex"},document.getElementById("pause-btn").onclick=()=>{e.pause(),document.getElementById("pause-btn").style.display="none",document.getElementById("play-btn").style.display="flex"},document.getElementById("next-btn").onclick=i}catch(e){t.innerHTML=`<div class="player-loading" style="color:var(--accent-color);"><i class="fas fa-exclamation-circle"></i> 歌曲加载失败：${e.message}</div>`}}e.addEventListener("ended",()=>{i()}),e.addEventListener("timeupdate",updateProgress),e.addEventListener("loadedmetadata",()=>{document.querySelector(".total-time-text").textContent=formatTime(e.duration)}),i()});
