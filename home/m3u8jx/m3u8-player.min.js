const exampleUrl="https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8";let art=null,isDarkMode=!1;document.getElementById("themeToggle").addEventListener("click",function(){isDarkMode=!isDarkMode,document.body.classList.toggle("dark-mode",isDarkMode);const e=this.querySelector("i");e.className=isDarkMode?"fas fa-sun":"fas fa-moon"});function createArtplayer(e){if(art)try{art.destroy()}catch(e){console.error("Error destroying player:",e)}art=null,art=new Artplayer({container:"#playerContainer",url:e,type:"m3u8",setting:!0,autoplay:!0,aspectRatio:!0,pip:!0,fullscreen:!0,fullscreenWeb:!0,playbackRate:!0,plugins:[artplayerPluginHlsControl({quality:{setting:!0,getName:e=>`${e.height}P`,title:"清晰度",auto:"自动"},audio:{setting:!0,getName:e=>e.name,title:"音轨",auto:"自动"}})],customType:{m3u8:function(e,t,a){if(Hls.isSupported()){a.hls&&a.hls.destroy();const r=new Hls({maxBufferLength:30,enableWorker:!0,backBufferLength:30});r.loadSource(t),r.attachMedia(e),a.hls=r,r.on(Hls.Events.MANIFEST_PARSED,function(){console.log("HLS manifest parsed:",r.levels),a.notice.show("视频加载成功")}),r.on(Hls.Events.ERROR,function(e,t){if(console.warn("HLS error",t),t.fatal)switch(t.type){case Hls.ErrorTypes.NETWORK_ERROR:a.notice.show("网络错误，正在重试..."),r.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:a.notice.show("媒体错误，尝试恢复..."),r.recoverMediaError();break;default:a.notice.show("播放错误，请重试")}})}else e.src=t}}})}document.getElementById("loadBtn").addEventListener("click",function(){const e=document.getElementById("urlInput").value.trim();return e?void createArtplayer(e):void(art&&art.notice.show("请输入 m3u8 地址"))}),document.getElementById("playExample").addEventListener("click",function(){document.getElementById("urlInput").value=exampleUrl,createArtplayer(exampleUrl)}),document.getElementById("urlInput").addEventListener("keydown",function(e){"Enter"===e.key&&this.value.trim()&&createArtplayer(this.value.trim())}),document.getElementById("urlInput").value=exampleUrl,createArtplayer(exampleUrl);
